<html>
<head>
    <link rel="stylesheet" type="text/css" href="/file?key=tmp.css">
    <script src="/file?key=jquery.js"></script>
    <style>
        form {grid-template-columns: repeat(3, max-content); /*label - 15px- username - 20px - password - 15px - error-label - 15px
                    - register button - 5px url to register*/
            grid-template-rows: max-content 15px max-content 20px max-content max-content max-content;
            align-items: center;
        }

        #title {
            grid-row: 1/2;
            grid-column: 1/4;
        }

        .text-input {
            height: 40px;
            grid-column: 2/4;
            margin-left: 20px;
        }

        .text-lbl {
            align-self: center;
            float: left;
            grid-column: 1/2;
        }

        .user-row {
            grid-row: 3/4;
        }

        .pswd-row {
            grid-row: 5/6;
        }

        #message {
            grid-row: 7/8;
            grid-column: 1/4;
            margin-bottom: 20px;
            margin-top: 20px;
        }

        #login {
            grid-row: 9/10;
            grid-column: 2/3;
        }

        .form-button:hover {
            background-color: #008CBA; /* Blue rgb(0, 140, 186)*/
        }

        #link-reg {
            grid-row: 11/12;
            grid-column: 1/4;
        }
    </style>
</head>
    <body>
        <form action="/login" method="POST" accept-charset="utf-8"
              class='center' ng-mo>
            <label id='title' class="title-style0 nonselect">Login to Social Painter</label>
            <label id="lbl-user" for='name' class="text-lbl label-style0 user-row nonselect">Username:</label>
            <input type="text" name='name' max="15" min="5" class='text-input text-input-style0 user-row' required>
            <label id='lbl-pswd' for='pswd' class="text-lbl label-style0 pswd-row nonselect">Password:</label>
            <input type="password" name="pswd" max="15" min="9" class='text-input text-input-style0 pswd-row'>
            <label id="message" class="error-lbl"></label>
            <!--pattern="^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)[A-Za-z\d@$!%*?&]{9,15}$" required>
            -->
            <input type='submit' value='Login' id='login' class='button-style0'>
            <a href="/register" id="link-reg" class="link-style0">Dont have an account?, Register now</a>
        </form>
        <script type="text/jsx">
        </script>
        <script>
            $('form').submit(function(e){
                e.preventDefault();
                let form = $(this);
                $.ajax({
                    url:form.attr('action'),
                    method:form.attr('method'),

                    data:form.serialize(),
                    success(data, status){
                        try{
                            if(data.code == 1){window.location.pathname = data.data;}
                            else {$('#message').text(data.text);}
                        }
                        catch(e)
                        {
                            console.log(e);
                            $('#message').text('Client Error');
                        }
                    }
                })
            })
            </script>        
    </body>    
</html>